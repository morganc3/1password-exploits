if(typeof arguments==="object"){a=arguments;DEBUG=a[a.length-1]==="debug";if(DEBUG){log_debug("Popping debug from end of arguments");a.pop()}}else{DEBUG=false}var Importers={};function log_warn(message){log("WARN",message)}function log_info(message){log("INFO",message)}function log_debug(message){if(DEBUG)log("DEBUG",message)}function log_error(message){log("ERROR",message)}function log_fatal(message){log("FATAL",message)}function log(level,message){var logFunc=print||console[level.toLowerCase()]||console.log;if(typeof importController==="object"){logFunc=importController.log}if(logFunc)logFunc("["+level.toUpperCase()+"] â€” "+message)}function dateToNSTimeInterval(inDate){var result=null;if(typeof inDate==="string"){result=Date.parse(inDate);if(isNaN(result)){log_debug("Could not convert string "+JSON.stringify(inDate)+" to Javascript Date object");return inDate}result=result/1e3}else if(typeof inDate==="object"&&inDate.constructor.name==="Date"){result=result.valueOf()/1e3}else if(typeof inDate==="number"&&inDate>9999999999){result=inDate/1e3}else if(typeof inDate==="number"){result=inDate}if(isNaN(result)){log_debug("Could not convert string "+JSON.stringify(inDate)+" to NSTimeInterval compatible value");return inDate}return result}function sanitizeMonthYear(inDate){log_debug("inDate: "+JSON.stringify(inDate));inDate=inDate.replace(/^(\d{1,2})[\/\-](\d{4}|\d{2})$/,function(match,$month,$year){var result=[];if($year.length===2){result.push("20")}result.push($year);result.push("-");if($month.length===1){result.push("0")}result.push($month);return result.join("")});inDate=inDate.replace(","," ");inDate=inDate.replace(/^\s*([A-Za-z]{3,})\s*(\d{2}|\d{4})?\s*$/,"$1 1 $2");log_debug("parseableDate: "+inDate);var parsedDate=Date.parse(inDate);if(isNaN(parsedDate)){log_debug("inDate: "+JSON.stringify(inDate)+" parsedDate: "+parsedDate);log_debug("Could not sanitize monthYear: "+inDate);return null}var date=new Date(parsedDate);var yearString=""+date.getUTCFullYear();var monthString=""+(date.getUTCMonth()+1);if(monthString.length===1)monthString="0"+monthString;var result=parseInt(yearString+monthString,10);if(isNaN(result))throw"Could not parse monthYear "+inDate;log_debug("outDate: "+result);return result}function bestValueMatchInMenu(value,menu){if(typeof menu==="string"){menu=menu.split(",")}else if(!Array.isArray(menu)){menu=Array(String(menu))}value=trimAndDowncaseString(value);menu=menu.map(trimAndDowncaseString);var i,found=menu.indexOf(value);if(found===-1){for(i=0;i<menu.length;i++){if(value.indexOf(menu[i])>-1||menu[i].indexOf(value)>-1){found=i;break}}}if(found===-1){for(i=0;i<menu.length;i++){if(stringAbbreviatesString(value,menu[i])||stringAbbreviatesString(menu[i],value)){found=i;break}}}return found}function trimAndDowncaseString(s){return String(s).toLowerCase().replace(/[^a-z]/,"")}function stringAbbreviatesString(s1,s2){var isAbbreviation=true;if(s1.length>=s2.length){isAbbreviation=false}else{var searchFrom=-1;for(var i=0;i<s1.length;i++){searchFrom=s2.indexOf(s1[i],searchFrom+1);if(searchFrom==-1){isAbbreviation=false;break}}}return isAbbreviation}function loginForRow(readonlyRow,map){var row=readonlyRow.slice();var login=new OPLogin;if(map==null)map=this.map.login;if(map.title!==undefined)login.setTitle(popRowFieldsAndReturnStringValue(row,map.title));if(map.username!==undefined)login.setUsername(popRowFieldsAndReturnStringValue(row,map.username));if(map.password!==undefined)login.setPassword(popRowFieldsAndReturnStringValue(row,map.password));if(map.location!==undefined)login.addURL(popRowFieldsAndReturnStringValue(row,map.location));if(map.notes!==undefined)login.addNotes(popRowFieldsAndReturnStringValue(row,map.notes));cleanupExtraFields.apply(this,[login,row,map]);return login}function driverLicenseForRow(readonlyRow,map){var row=readonlyRow.slice();var license=new OPDriverLicense;if(map==null)map=this.map.driverlicense;if(map.title!==undefined)license.setTitle(popRowFieldsAndReturnStringValue(row,map.title));if(map.name!==undefined)license.setName(popRowFieldsAndReturnStringValue(row,map.name));if(map.number!==undefined)license.setNumber(popRowFieldsAndReturnStringValue(row,map.number));if(map.address!==undefined)license.setAddress(popRowFieldsAndReturnStringValue(row,map.address));if(map.birthdate!==undefined)license.setBirthdate(popRowFieldsAndReturnStringValue(row,map.birthdate));if(map.sex!==undefined)license.setSex(popRowFieldsAndReturnStringValue(row,map.sex));if(map.height!==undefined)license.setHeight(popRowFieldsAndReturnStringValue(row,map.height));if(map.conditions!==undefined)license.setConditions(popRowFieldsAndReturnStringValue(row,map.conditions));if(map.state!==undefined)license.setState(popRowFieldsAndReturnStringValue(row,map.state));if(map.country!==undefined)license.setCountry(popRowFieldsAndReturnStringValue(row,map.country));if(map.licenseclass!==undefined)license.setLicenseClass(popRowFieldsAndReturnStringValue(row,map.licenseclass));if(map.expirydate!==undefined)license.setExpirationDate(popRowFieldsAndReturnStringValue(row,map.expirydate));if(map.notes!==undefined)license.addNotes(popRowFieldsAndReturnStringValue(row,map.notes));cleanupExtraFields.apply(this,[license,row,map]);return license}function identityForRow(readonlyRow,map){var row=readonlyRow.slice();var identity=new OPIdentity;if(map==null)map=this.map.identity;if(map.title!==undefined)identity.setTitle(popRowFieldsAndReturnStringValue(row,map.title));if(map.firstname!==undefined)identity.setFirstName(popRowFieldsAndReturnStringValue(row,map.firstname));if(map.middlename!==undefined)identity.setInitial(popRowFieldsAndReturnStringValue(row,map.middlename));if(map.lastname!==undefined)identity.setLastName(popRowFieldsAndReturnStringValue(row,map.lastname));if(map.street!==undefined)identity.setStreetAddress(popRowFieldsAndReturnStringValue(row,map.street,"\n"));if(map.city!==undefined)identity.setCity(popRowFieldsAndReturnStringValue(row,map.city));if(map.state!==undefined)identity.setState(popRowFieldsAndReturnStringValue(row,map.state));if(map.country!==undefined)identity.setCountry(popRowFieldsAndReturnStringValue(row,map.country));if(map.zip!==undefined)identity.setZip(popRowFieldsAndReturnStringValue(row,map.zip));if(map.defphone!==undefined)identity.setDefaultPhone(popRowFieldsAndReturnStringValue(row,map.defphone,"-"));if(map.homephone!==undefined)identity.setHomePhone(popRowFieldsAndReturnStringValue(row,map.homephone,"-"));if(map.cellphone!==undefined)identity.setCellPhone(popRowFieldsAndReturnStringValue(row,map.cellphone,"-"));if(map.fax!==undefined)identity.setFax(popRowFieldsAndReturnStringValue(row,map.fax,"-"));if(map.username!==undefined)identity.setUsername(popRowFieldsAndReturnStringValue(row,map.username));if(map.email!==undefined)identity.setEmail(popRowFieldsAndReturnStringValue(row,map.email));if(map.sex!==undefined)identity.setSex(popRowFieldsAndReturnStringValue(row,map.sex));if(map.birthday!==undefined)identity.setBirthdate(popRowFieldsAndReturnStringValue(row,map.birthday));if(map.company!==undefined)identity.setCompany(popRowFieldsAndReturnStringValue(row,map.company));if(map.notes!==undefined)identity.addNotes(popRowFieldsAndReturnStringValue(row,map.notes));cleanupExtraFields.apply(this,[identity,row,map]);return identity}function creditCardForRow(readonlyRow,map){var row=readonlyRow.slice();var cc=new OPCreditCard;if(map==null)map=this.map.creditcard;if(map.title!==undefined)cc.setTitle(popRowFieldsAndReturnStringValue(row,map.title));if(map.cardnumber!==undefined)cc.setCardNumber(popRowFieldsAndReturnStringValue(row,map.cardnumber));if(map.cardtype!==undefined)cc.setCardType(popRowFieldsAndReturnStringValue(row,map.cardtype));if(map.validfrom!==undefined)cc.setValidFrom(popRowFieldsAndReturnStringValue(row,map.validfrom));if(map.expirydate!==undefined)cc.setExpirationDate(popRowFieldsAndReturnStringValue(row,map.expirydate));if(map.cvv!==undefined)cc.setCVV(popRowFieldsAndReturnStringValue(row,map.cvv));if(map.cardholder!==undefined)cc.setCardholder(popRowFieldsAndReturnStringValue(row,map.cardholder));if(map.notes!==undefined)cc.addNotes(popRowFieldsAndReturnStringValue(row,map.notes));cleanupExtraFields.apply(this,[cc,row,map]);return cc}function bankAccountForRow(readonlyRow,map){var row=readonlyRow.slice();var bankAccount=new OPBankAccount;if(map==null)map=this.map.bankaccount;if(map.title!==undefined)bankAccount.setTitle(popRowFieldsAndReturnStringValue(row,map.title));if(map.bankname!==undefined)bankAccount.setBankName(popRowFieldsAndReturnStringValue(row,map.bankname));if(map.accounttype!==undefined)bankAccount.setAccountType(popRowFieldsAndReturnStringValue(row,map.accounttype));if(map.accountnumber!==undefined)bankAccount.setAccountNumber(popRowFieldsAndReturnStringValue(row,map.accountnumber));if(map.routingnumber!==undefined)bankAccount.setRoutingNumber(popRowFieldsAndReturnStringValue(row,map.routingnumber));if(map.owner!==undefined)bankAccount.setOwner(popRowFieldsAndReturnStringValue(row,map.owner));if(map.swift!==undefined)bankAccount.setSwift(popRowFieldsAndReturnStringValue(row,map.swift));if(map.iban!==undefined)bankAccount.setIban(popRowFieldsAndReturnStringValue(row,map.iban));if(map.pin!==undefined)bankAccount.setTelephonePin(popRowFieldsAndReturnStringValue(row,map.pin));if(map.bankaddress!==undefined)bankAccount.setBranchAddress(popRowFieldsAndReturnStringValue(row,map.bankaddress));if(map.bankphone!==undefined)bankAccount.setBranchPhone(popRowFieldsAndReturnStringValue(row,map.bankphone));if(map.notes!==undefined)bankAccount.addNotes(popRowFieldsAndReturnStringValue(row,map.notes));cleanupExtraFields.apply(this,[bankAccount,row,map]);return bankAccount}function socialSecurityNumberForRow(readonlyRow,map){var row=readonlyRow.slice();var socialSecurityNumber=new OPSocialSecurityNumber;if(map==null)map=this.map.socialsecuritynumber;if(map.title!==undefined)socialSecurityNumber.setTitle(popRowFieldsAndReturnStringValue(row,map.title));if(map.name!==undefined)socialSecurityNumber.setName(popRowFieldsAndReturnStringValue(row,map.name));if(map.number!==undefined)socialSecurityNumber.setNumber(popRowFieldsAndReturnStringValue(row,map.number));if(map.notes!==undefined)socialSecurityNumber.addNotes(popRowFieldsAndReturnStringValue(row,map.notes));cleanupExtraFields.apply(this,[socialSecurityNumber,row,map]);return socialSecurityNumber}function softwareLicenseForRow(readonlyRow,map){var row=readonlyRow.slice();var softwareLicense=new OPSoftwareLicense;if(map==null)map=this.map.software;if(map.title!==undefined)softwareLicense.setTitle(popRowFieldsAndReturnStringValue(row,map.title));if(map.version!==undefined)softwareLicense.setVersion(popRowFieldsAndReturnStringValue(row,map.version));if(map.licensekey!==undefined)softwareLicense.setLicenseKey(popRowFieldsAndReturnStringValue(row,map.licensekey));if(map.owner!==undefined)softwareLicense.setOwner(popRowFieldsAndReturnStringValue(row,map.owner));if(map.email!==undefined)softwareLicense.setEmail(popRowFieldsAndReturnStringValue(row,map.email));if(map.company!==undefined)softwareLicense.setCompany(popRowFieldsAndReturnStringValue(row,map.company));if(map.downloadlink!==undefined)softwareLicense.setDownloadLink(popRowFieldsAndReturnStringValue(row,map.downloadlink));if(map.publisher!==undefined)softwareLicense.setPublisher(popRowFieldsAndReturnStringValue(row,map.publisher));if(map.publisherwebsite!==undefined)softwareLicense.setPublisherWebsite(popRowFieldsAndReturnStringValue(row,map.publisherwebsite));if(map.retailprice!==undefined)softwareLicense.setRetailPrice(popRowFieldsAndReturnStringValue(row,map.retailprice));if(map.supportemail!==undefined)softwareLicense.setSupportEmail(popRowFieldsAndReturnStringValue(row,map.supportemail));if(map.purchasedate!==undefined)softwareLicense.setPurchaseDate(popRowFieldsAndReturnStringValue(row,map.purchasedate));if(map.ordernumber!==undefined)softwareLicense.setOrderNumber(popRowFieldsAndReturnStringValue(row,map.ordernumber));if(map.ordertotal!==undefined)softwareLicense.setOrderTotal(popRowFieldsAndReturnStringValue(row,map.ordertotal));if(map.notes!==undefined)softwareLicense.addNotes(popRowFieldsAndReturnStringValue(row,map.notes));cleanupExtraFields.apply(this,[softwareLicense,row,map]);return softwareLicense}function secureNoteForRow(readonlyRow,map){var row=readonlyRow.slice();var note=new OPSecureNote;if(map==null)map=this.map.securenote;if(map.title!==undefined)note.setTitle(popRowFieldsAndReturnStringValue(row,map.title));if(map.body!==undefined)note.setBody(popRowFieldsAndReturnStringValue(row,map.body));cleanupExtraFields.apply(this,[note,row,map]);return note}function guid(){function _p8(s){var p=(Math.random().toString(16)+"000000000").substr(2,8);return s?"-"+p.substr(0,4)+"-"+p.substr(4,4):p}return _p8()+_p8(true)+_p8(true)+_p8()}function cleanupExtraFields(item,row,map){if(map.ignore!==undefined)popRowFieldsAndReturnStringValue(row,map.ignore);if(map.extras===undefined){addRemainingRowFieldsToItem.apply(this,[item,row])}else{addSpecifiedExtraFieldsToItem.apply(this,[item,row,map.extras])}}function addRemainingRowFieldsToItem(item,row){var section={name:guid(),title:"Other Fields"};row.forEach(function(field,index){var fieldName;if(field){if(this.fieldNames[index]===undefined){fieldName="Field "+(index+1)}else{fieldName=this.fieldNames[index]}item.addCustomField(fieldName,field)}},this)}function addSpecifiedExtraFieldsToItem(item,row,fields){if(fields==null)return fields;else if(typeof fields==="number")fields=[fields];if(fields.constructor&&fields.constructor.name==="Array"){for(var i=0;i<fields.length;i++){var fieldName,index=fields[i];if(index<0)index=row.length+index;if(row[index]){if(this.fieldNames[index]===undefined){fieldName="Field "+(index+1)}else{fieldName=this.fieldNames[index]}item.addCustomField(fieldName,row[index])}}}}function popRowFieldsAndReturnStringValue(row,fields,separator){var result=[];if(fields==null)return fields;if(separator===undefined)separator=" ";if(fields.constructor&&fields.constructor.name==="Array"){for(var i=0;i<fields.length;i++){var index=fields[i];if(index<0)index=row.length+index;if(row[index]!==""){result.push(row[index]);row[index]=""}}}else{if(fields<0)fields=row.length+fields;result.push(row[fields]);row[fields]=""}return result.join(separator).replace(new RegExp("^"+separator+"+|"+separator+"+$","g"),"")}var CSVParser=function(){"use strict";function captureFields(fields){if(this.options.ignoreEmpty===false||fields.some(function(field){return field.length!==0})){this.rows.push(fields)}}function Parser(data,options){var defaultOptions={fieldSeparator:",",strict:true,ignoreEmpty:true};if(options===undefined)options={};this.options={};Object.keys(defaultOptions).forEach(function(key){this.options[key]=options[key]===undefined?defaultOptions[key]:options[key]},this);this.rows=[];this.data=data}Parser.prototype.toString=function toString(){return"[object CSVParser]"};Parser.prototype.numberOfRows=function numberOfRows(){return this.rows.length};Parser.prototype.parse=function parse(){var regexString="(\\"+this.options.fieldSeparator+"|\\r?\\n|\\r|^)"+'(?:"([^"]*(?:""[^"]*)*)"|'+'([^"\\'+this.options.fieldSeparator+"\\r\\n]*))";var objPattern=new RegExp(regexString,"gi");var doubleQuotePattern=new RegExp('""',"g");var fields=[];var arrMatches=null;var strMatchedDelimiter,strMatchedValue;while(arrMatches=objPattern.exec(this.data)){strMatchedDelimiter=arrMatches[1];if(strMatchedDelimiter.length&&strMatchedDelimiter!=this.options.fieldSeparator){captureFields.apply(this,[fields]);fields=[]}if(arrMatches[2]){strMatchedValue=arrMatches[2].replace(doubleQuotePattern,'"')}else{strMatchedValue=arrMatches[3]}fields.push(strMatchedValue)}captureFields.apply(this,[fields]);if(this.options.strict===true&&!this.rows.every(function(row){return row.length===this.length},this.rows[0])){throw new Error("Invalid CSV data. Strict mode requires all rows to have the same number of fields. You can override this by passing `strict: false` in the CSVParser options")}};return Parser}();function OPBankAccount(){var that=this;this.details={sections:[]};this.categoryUUID="101";this.overview={};this.title=function getTitle(){return this.overview.title};this.setTitle=function setTitle(aTitle){this.overview.title=aTitle};this.notes=function getNotes(){return this.details.notesPlain};this.setNotes=function setNotes(notes){this.details.notesPlain=notes};this.addNotes=function addNotes(noteText,separator){var notes=this.details.notesPlain||"";if(notes!==""&&separator)notes+=separator;notes+=noteText;this.setNotes(notes)};this.bankName=function getBankName(){var field=fieldWithNameInSection("bankName","");if(field){return field.v}};this.setBankName=function setBankName(bankName){var field=fieldWithNameInSection("bankName",""),fieldMap;if(field){field.v=bankName}else{fieldMap={k:"string",n:"bankName",t:"bank name",v:bankName};addFieldToSection(fieldMap,{name:"",title:""})}};this.owner=function getOwner(){var field=fieldWithNameInSection("owner","");if(field){return field.v}};this.setOwner=function setOwner(owner){var field=fieldWithNameInSection("owner",""),fieldMap;if(field){field.v=owner}else{fieldMap={k:"string",n:"owner",t:"name on account",v:owner};addFieldToSection(fieldMap,{name:"",title:""})}};this.accountType=function accountType(){var field=fieldWithNameInSection("accountType","");if(field){return field.v}};this.setAccountType=function setAccountType(type){var field=fieldWithNameInSection("accountType",""),fieldMap;var menu_options=["checking","savings","loc","atm","money_market","other"];var menu_match=bestValueMatchInMenu(type,menu_options);if(menu_match==-1){this.addCustomField("type",type)}else{type=menu_options[menu_match];if(field){field.v=type}else{fieldMap={k:"menu",n:"accountType",t:"type",v:type};addFieldToSection(fieldMap,{name:"",title:""})}}};this.routingNumber=function getRoutingNumber(){var field=fieldWithNameInSection("routingNo","");if(field){return field.v}};this.setRoutingNumber=function setRoutingNumber(routingNumber){var field=fieldWithNameInSection("routingNo",""),fieldMap;if(field){field.v=routingNumber}else{fieldMap={k:"string",n:"routingNo",t:"routing number",v:routingNumber};addFieldToSection(fieldMap,{name:"",title:""})}};this.accountNumber=function getAccountNumber(){var field=fieldWithNameInSection("accountNo","");if(field){return field.v}};this.setAccountNumber=function setAccountNumber(accountNumber){var field=fieldWithNameInSection("accountNo",""),fieldMap;if(field){field.v=accountNumber}else{fieldMap={k:"string",n:"accountNo",t:"account number",v:accountNumber};addFieldToSection(fieldMap,{name:"",title:""})}};this.swift=function getSwift(){var field=fieldWithNameInSection("swift","");if(field){return field.v}};this.setSwift=function setSwift(swift){var field=fieldWithNameInSection("swift",""),fieldMap;if(field){field.v=swift}else{fieldMap={k:"string",n:"swift",t:"SWIFT",v:swift};addFieldToSection(fieldMap,{name:"",title:""})}};this.iban=function getIban(){var field=fieldWithNameInSection("iban","");if(field){return field.v}};this.setIban=function setIban(iban){var field=fieldWithNameInSection("iban",""),fieldMap;if(field){field.v=iban}else{fieldMap={k:"string",n:"iban",t:"IBAN",v:iban};addFieldToSection(fieldMap,{name:"",title:""})}};this.telephonePin=function getTelephonePin(){var field=fieldWithNameInSection("","");if(field){return field.v}};this.setTelephonePin=function setTelephonePin(pin){var field=fieldWithNameInSection("telephonePin",""),fieldMap;if(field){field.v=pin}else{fieldMap={k:"concealed",n:"telephonePin",t:"PIN",v:pin,a:{generate:"off"}};addFieldToSection(fieldMap,{name:"",title:""})}};this.branchPhone=function getBranchPhone(){var field=fieldWithNameInSection("branchPhone","branchInfo");if(field){return field.v}};this.setBranchPhone=function setBranchPhone(phone){var field=fieldWithNameInSection("branchPhone","branchInfo"),fieldMap;if(field){field.v=phone}else{fieldMap={k:"phone",n:"branchPhone",t:"phone",v:phone};addFieldToSection(fieldMap,{name:"branchInfo",title:"Branch Information"})}};this.branchAddress=function getBranchAddress(){var field=fieldWithNameInSection("branchAddress","branchInfo");if(field){return field.v}};this.setBranchAddress=function setBranchAddress(address){var field=fieldWithNameInSection("branchAddress","branchInfo"),fieldMap;if(field){field.v=address}else{fieldMap={k:"string",n:"branchAddress",t:"address",v:address};addFieldToSection(fieldMap,{name:"branchInfo",title:"Branch Information"})}};this.URL=function getURL(){var field=fieldWithNameInSection("AA08BEF8204C408897B6278A208BB69F","Section_85B6A33F26AF41D4B32C8A1D4B81497D");if(field){return field.v}};this.setURL=function setURL(URL){var field=fieldWithNameInSection("AA08BEF8204C408897B6278A208BB69F","Section_85B6A33F26AF41D4B32C8A1D4B81497D"),fieldMap;if(field){field.v=URL}else{fieldMap={k:"URL",n:"AA08BEF8204C408897B6278A208BB69F",t:"URL",v:URL};addFieldToSection(fieldMap,{name:"Section_85B6A33F26AF41D4B32C8A1D4B81497D",title:"Internet Banking"})}};var customFieldsSection={name:guid(),title:"Other Fields"};this.addCustomField=function addCustomField(fieldName,fieldValue){addFieldToSection({k:"string",t:fieldName,v:fieldValue},customFieldsSection)};function fieldWithNameInSection(fieldName,sectionName){var section=sectionNamed(sectionName);if(section){fields=section.fields.filter(function(field){return field.n===fieldName});if(fields.length>1){}return fields[0]}}function sectionNamed(needle){var matchedSections=that.details.sections.filter(function(section){return section.name===needle});if(matchedSections.length>1){}return matchedSections[0]}function addFieldToSection(fieldObject,inSection){var section=sectionNamed(inSection.name);if(!section){that.details.sections.push({fields:[fieldObject],name:inSection.name,title:inSection.title})}else{section.fields.push(fieldObject)}}}function OPCreditCard(){var that=this;this.details={sections:[]};this.categoryUUID="002";this.overview={};this.title=function getTitle(){return this.overview.title};this.setTitle=function setTitle(aTitle){this.overview.title=aTitle};this.cardholder=function getCardholder(){var field=fieldWithNameInSection("cardholder","");if(field){return field.v}};this.setCardholder=function setCardholder(newName){var field=fieldWithNameInSection("cardholder",""),fieldMap;if(field){field.v=newName}else{fieldMap={a:{guarded:"yes"},k:"string",n:"cardholder",t:"cardholder name",v:newName};addFieldToSection(fieldMap,{name:"",title:""})}};this.cardType=function getCardType(){var field=fieldWithNameInSection("type","");if(field){return field.v}};this.setCardType=function setCardType(typeValue){var field=fieldWithNameInSection("type",""),fieldMap;var menu_options=["visa","mc","amex","diners","carteblanche","discover","jcb","maestro","visaelectron","laser","unionpay"];var menu_match=bestValueMatchInMenu(typeValue,menu_options);if(menu_match==-1){this.addCustomField("type",typeValue)}else{typeValue=menu_options[menu_match];if(field){field.v=typeValue}else{fieldMap={a:{guarded:"yes"},k:"cctype",n:"type",t:"type",v:typeValue};addFieldToSection(fieldMap,{name:"",title:""})}}};this.cardNumber=function getCardNumber(){var field=fieldWithNameInSection("ccnum","");if(field){return field.v}};this.setCardNumber=function setCardNumber(cardNumber){var field=fieldWithNameInSection("ccnum",""),fieldMap;if(field){field.v=cardNumber}else{fieldMap={a:{clipboardFilter:"0123456789",guarded:"yes"},k:"string",n:"ccnum",t:"number",v:cardNumber};addFieldToSection(fieldMap,{name:"",title:""})}};this.CVV=function getCVV(){var field=fieldWithNameInSection("cvv","");if(field){return field.v}};this.setCVV=function setCVV(cvv){var field=fieldWithNameInSection("cvv",""),fieldMap;if(field){field.v=cvv}else{fieldMap={a:{generate:"off",guarded:"yes"},k:"concealed",n:"cvv",t:"verification number",v:cvv};addFieldToSection(fieldMap,{name:"",title:""})}};this.expirationDate=function getExpirationDate(){var field=fieldWithNameInSection("expiry","");if(field){return field.v}};this.setExpirationDate=function setExpirationDate(expiryMonthYear){var sanitizedMonthYear=sanitizeMonthYear(expiryMonthYear),field=fieldWithNameInSection("expiry",""),fieldMap;if(field){field.v=sanitizedMonthYear}else{fieldMap={a:{guarded:"yes"},k:"monthYear",n:"expiry",t:"expiry date",v:sanitizedMonthYear};addFieldToSection(fieldMap,{name:"",title:""})}};this.validFrom=function getValidFrom(){var field=fieldWithNameInSection("validfrom","");if(field){return field.v}};this.setValidFrom=function setValidFrom(validFrom){var field=fieldWithNameInSection("validfrom",""),fieldMap,sanitizedMonthYear=sanitizeMonthYear(validFrom);if(field){field.v=sanitizedMonthYear}else{fieldMap={a:{guarded:"yes"},k:"monthYear",n:"validFrom",t:"valid from",v:sanitizedMonthYear};addFieldToSection(fieldMap,{name:"",title:""})}};this.bank=function getBank(){var field=fieldWithNameInSection("bank","contactInfo");if(field){return field.v}};this.setBank=function setBank(bank){var field=fieldWithNameInSection("bank","contactInfo"),fieldMap;if(field){field.v=bank}else{fieldMap={k:"string",n:"bank",t:"issuing bank",v:bank};addFieldToSection(fieldMap,{name:"contactInfo",title:"Contact Information"})}};this.localPhone=function getLocalPhone(){var field=fieldWithNameInSection("phoneLocal","contactInfo");if(field){return field.v}};this.setLocalPhone=function setLocalPhone(localPhone){var field=fieldWithNameInSection("phoneLocal","contactInfo"),fieldMap;if(field){field.v=localPhone}else{fieldMap={k:"phone",n:"phoneLocal",t:"phone (local)",v:localPhone};addFieldToSection(fieldMap,{name:"contactInfo",title:"Contact Information"})}};this.tollFreePhone=function getTollFreePhone(){var field=fieldWithNameInSection("phoneTollFree","contactInfo");if(field){return field.v}};this.setTollFreePhone=function setTollFreePhone(tollFreePhone){var field=fieldWithNameInSection("phoneTollFree","contactInfo"),fieldMap;if(field){field.v=localPhone}else{fieldMap={k:"phone",n:"phoneTollFree",t:"phone (toll free)",v:tollFreePhone};addFieldToSection(fieldMap,{name:"contactInfo",title:"Contact Information"})}};this.internationalPhone=function getInternationalPhone(){var field=fieldWithNameInSection("phoneIntl","contactInfo");if(field){return field.v}};this.setInternationalPhone=function setInternationalPhone(internationalPhone){var field=fieldWithNameInSection("phoneIntl","contactInfo"),fieldMap;if(field){field.v=localPhone}else{fieldMap={k:"phone",n:"phoneIntl",t:"phone (intl)",v:tollFreePhone};addFieldToSection(fieldMap,{name:"contactInfo",title:"Contact Information"})}};this.website=function getWebsite(){var field=fieldWithNameInSection("website","contactInfo");if(field){return field.v}};this.setWebsite=function setWebsite(website){var field=fieldWithNameInSection("website","contactInfo"),fieldMap;if(field){field.v=localPhone}else{fieldMap={k:"URL",n:"website",t:"website",v:website};addFieldToSection(fieldMap,{name:"contactInfo",title:"Contact Information"})}};this.PIN=function getPIN(){var field=fieldWithNameInSection("pin","details");if(field){return field.v}};this.setPIN=function setPIN(PIN){var field=fieldWithNameInSection("pin","details"),fieldMap;if(field){field.v=PIN}else{fieldMap={a:{generate:"off"},k:"concealed",n:"pin",t:"PIN",v:PIN};addFieldToSection(fieldMap,{name:"details",title:"Additional Details"})}};this.creditLimit=function getCreditLimit(){var field=fieldWithNameInSection("creditlimit","details");if(field){return field.v}};this.setCreditLimit=function setCreditLimit(creditLimit){var field=fieldWithNameInSection("creditlimit","details"),fieldMap;if(field){field.v=creditLimit}else{fieldMap={k:"string",n:"creditLimit",t:"credit limit",v:creditLimit};addFieldToSection(fieldMap,{name:"details",title:"Additional Details"})}};this.cashLimit=function getCashLimit(){var field=fieldWithNameInSection("cashLimit","details");if(field){return field.v}};this.setCashLimit=function setCashLimit(cashLimit){var field=fieldWithNameInSection("cashLimit","details"),fieldMap;if(field){field.v=cashLimit}else{fieldMap={k:"string",n:"cashLimit",t:"cash withdrawal limit",v:cashLimit};addFieldToSection(fieldMap,{name:"details",title:"Additional Details"})}};this.interestRate=function getInterestRate(){var field=fieldWithNameInSection("interest","details");if(field){return field.v}};this.setInterestRate=function setInterestRate(interestRate){var field=fieldWithNameInSection("interest","details"),fieldMap;if(field){field.v=interestRate}else{fieldMap={k:"string",n:"interest",t:"interest rate",v:interestRate};addFieldToSection(fieldMap,{name:"details",title:"Additional Details"})}};this.issueNumber=function getIssueNumber(){var field=fieldWithNameInSection("issuenumber","details");if(field){return field.v}};this.setIssueNumber=function setInterestRate(issueNumber){var field=fieldWithNameInSection("issuenumber","details"),fieldMap;if(field){field.v=issueNumber}else{fieldMap={k:"string",n:"issuenumber",t:"issue number",v:issueNumber};addFieldToSection(fieldMap,{name:"details",title:"Additional Details"})}};this.notes=function getNotes(){return this.details.notesPlain};this.setNotes=function setNotes(notes){this.details.notesPlain=notes};this.addNotes=function addNotes(noteText,separator){var notes=this.details.notesPlain||"";if(notes!==""&&separator)notes+=separator.toString();notes+=noteText;this.setNotes(notes)};var customFieldsSection={name:guid(),title:"Other Fields"};this.addCustomField=function addCustomField(fieldName,fieldValue){addFieldToSection({k:"string",t:fieldName,v:fieldValue},customFieldsSection)};this.toString=function toString(){return"[object OPCreditCard]"};function fieldWithNameInSection(fieldName,sectionName){var section=sectionNamed(sectionName);if(section){fields=section.fields.filter(function(field){return field.n===fieldName});if(fields.length>1){}return fields[0]}}function addFieldToSection(fieldObject,inSection){var section=sectionNamed(inSection.name);if(!section){that.details.sections.push({fields:[fieldObject],name:inSection.name,title:inSection.title})}else{section.fields.push(fieldObject)}}function sectionNamed(needle){var matchedSections=that.details.sections.filter(function(section){return section.name===needle});if(matchedSections.length>1){}return matchedSections[0]}}function OPDriverLicense(){var that=this;this.categoryUUID="103";this.details={sections:[]};this.overview={};this.title=function getTitle(){return this.overview.title};this.setTitle=function setTitle(aTitle){this.overview.title=aTitle};this.notes=function getNotes(){return this.details.notesPlain};this.setNotes=function setNotes(notes){this.details.notesPlain=notes};this.addNotes=function addNotes(noteText,separator){var notes=this.details.notesPlain||"";if(notes!==""&&separator!=null)notes+=separator;notes+=noteText;this.setNotes(notes)};this.name=function getName(){var field=fieldWithNameInSection("fullname","");if(field){return field.v}};this.setName=function setName(value){var field=fieldWithNameInSection("fullname",""),fieldMap;if(field){field.v=value}else{fieldMap={k:"string",n:"fullname",t:"full name",v:value};addFieldToSection(fieldMap,{name:"",title:""})}};this.address=function getAddress(){var field=fieldWithNameInSection("address","");if(field){return field.v}};this.setAddress=function setAddress(value){var field=fieldWithNameInSection("address",""),fieldMap;if(field){field.v=value}else{fieldMap={k:"string",n:"address",t:"address",v:value};addFieldToSection(fieldMap,{name:"",title:""})}};this.birthdate=function getBirthdate(){var field=fieldWithNameInSection("birthdate","");if(field){return field.v}};this.setBirthdate=function setBirthdate(value){var field=fieldWithNameInSection("birthdate",""),fieldMap;var date=dateToNSTimeInterval(value);if(typeof date!=="number"){this.addCustomField("date of birth",date)}else{if(field){field.v=date}else{fieldMap={k:"date",n:"birthdate",t:"date of birth",v:date};addFieldToSection(fieldMap,{name:"",title:""})}}};this.sex=function getSex(){var field=fieldWithNameInSection("sex","name");
if(field){return field.v}};this.setSex=function setSex(sex){if(sex==="m"){sex="male"}else if(sex==="f"){sex="female"}if(["male","female"].indexOf(sex)===-1)return;var field=fieldWithNameInSection("sex","name"),fieldMap;if(field){field.v=sex}else{fieldMap={k:"menu",n:"sex",t:"sex",v:sex};addFieldToSection(fieldMap,{name:"name",title:"Identification"})}};this.height=function getHeight(){var field=fieldWithNameInSection("height","");if(field){return field.v}};this.setHeight=function setHeight(value){var field=fieldWithNameInSection("height",""),fieldMap;if(field){field.v=value}else{fieldMap={k:"string",n:"height",t:"height",v:value};addFieldToSection(fieldMap,{name:"",title:""})}};this.number=function getNumber(){var field=fieldWithNameInSection("number","");if(field){return field.v}};this.setNumber=function setNumber(value){var field=fieldWithNameInSection("number",""),fieldMap;if(field){field.v=value}else{fieldMap={k:"string",n:"number",t:"number",v:value};addFieldToSection(fieldMap,{name:"",title:""})}};this.licenseClass=function getLicenseClass(){var field=fieldWithNameInSection("class","");if(field){return field.v}};this.setLicenseClass=function setLicenseClass(value){var field=fieldWithNameInSection("class",""),fieldMap;if(field){field.v=value}else{fieldMap={k:"string",n:"class",t:"license class",v:value};addFieldToSection(fieldMap,{name:"",title:""})}};this.conditions=function getConditions(){var field=fieldWithNameInSection("conditions","");if(field){return field.v}};this.setConditions=function setConditions(value){var field=fieldWithNameInSection("conditions",""),fieldMap;if(field){field.v=value}else{fieldMap={k:"string",n:"conditions",t:"conditions / restrictions",v:value};addFieldToSection(fieldMap,{name:"",title:""})}};this.state=function getState(){var field=fieldWithNameInSection("state","");if(field){return field.v}};this.setState=function setState(value){var field=fieldWithNameInSection("state",""),fieldMap;if(field){field.v=value}else{fieldMap={k:"string",n:"state",t:"state",v:value};addFieldToSection(fieldMap,{name:"",title:""})}};this.country=function getCountry(){var field=fieldWithNameInSection("country","");if(field){return field.v}};this.setCountry=function setCountry(value){var field=fieldWithNameInSection("country",""),fieldMap;if(field){field.v=value}else{fieldMap={k:"string",n:"country",t:"country",v:value};addFieldToSection(fieldMap,{name:"",title:""})}};this.expirationDate=function getExpirationDate(){var field=fieldWithNameInSection("expiry_date","");if(field){return field.v}};this.setExpirationDate=function setExpirationDate(expiryMonthYear){var sanitizedMonthYear=sanitizeMonthYear(expiryMonthYear),field=fieldWithNameInSection("expiry_date",""),fieldMap;if(field){field.v=sanitizedMonthYear}else{fieldMap={k:"monthYear",n:"expiry_date",t:"expiry date",v:sanitizedMonthYear};addFieldToSection(fieldMap,{name:"",title:""})}};var customFieldsSection={name:guid(),title:"Other Fields"};this.addCustomField=function addCustomField(fieldName,fieldValue){addFieldToSection({k:"string",t:fieldName,v:fieldValue},customFieldsSection)};function fieldWithNameInSection(fieldName,sectionName){var section=sectionNamed(sectionName);if(section){fields=section.fields.filter(function(field){return field.n===fieldName});if(fields.length>1){}return fields[0]}}function sectionNamed(needle){var matchedSections=that.details.sections.filter(function(section){return section.name===needle});if(matchedSections.length>1){}return matchedSections[0]}function addFieldToSection(fieldObject,inSection){var section=sectionNamed(inSection.name);if(!section){that.details.sections.push({fields:[fieldObject],name:inSection.name,title:inSection.title})}else{section.fields.push(fieldObject)}}}function OPIdentity(){var that=this;this.details={sections:[]};this.categoryUUID="004";this.overview={};this.title=function getTitle(){return this.overview.title};this.setTitle=function setTitle(aTitle){this.overview.title=aTitle};this.notes=function getNotes(){return this.details.notesPlain};this.setNotes=function setNotes(notes){this.details.notesPlain=notes};this.addNotes=function addNotes(noteText,separator){var notes=this.details.notesPlain||"";if(notes!==""&&separator!=null)notes+=separator;notes+=noteText;this.setNotes(notes)};this.firstName=function getFirstName(){var field=fieldWithNameInSection("firstname","name");if(field){return field.v}};this.setFirstName=function setFirstName(firstName){var field=fieldWithNameInSection("firstname","name"),fieldMap;if(field){field.v=firstName}else{fieldMap={k:"string",n:"firstName",t:"first name",v:firstName,a:{guarded:"yes"}};addFieldToSection(fieldMap,{name:"name",title:"Identification"})}};this.lastName=function getLastName(){var field=fieldWithNameInSection("lastname","name");if(field){return field.v}};this.setLastName=function setLastName(lastName){var field=fieldWithNameInSection("lastname","name"),fieldMap;if(field){field.v=lastName}else{fieldMap={k:"string",n:"lastName",t:"last name",v:lastName,a:{guarded:"yes"}};addFieldToSection(fieldMap,{name:"name",title:"Identification"})}};this.initial=function getInitial(){var field=fieldWithNameInSection("name","");if(field){return field.v}};this.setInitial=function setInitial(initial){var field=fieldWithNameInSection("initial","name"),fieldMap;if(field){field.v=initial}else{fieldMap={k:"string",n:"initial",t:"initial",v:initial,a:{guarded:"yes"}};addFieldToSection(fieldMap,{name:"name",title:"Identification"})}};this.sex=function getSex(){var field=fieldWithNameInSection("sex","name");if(field){return field.v}};this.setSex=function setSex(sex){sex=trimAndDowncaseString(sex);if(sex==="m"){sex="male"}else if(sex==="f"){sex="female"}if(["male","female"].indexOf(sex)===-1)return;var field=fieldWithNameInSection("sex","name"),fieldMap;if(field){field.v=sex}else{fieldMap={k:"menu",n:"sex",t:"sex",v:sex,a:{guarded:"yes"}};addFieldToSection(fieldMap,{name:"name",title:"Identification"})}};this.birthdate=function getBirthdate(){var field=fieldWithNameInSection("birthdate","name");if(field){return field.v}};this.setBirthdate=function setBirthdate(birthdate){var field=fieldWithNameInSection("birthdate","name"),fieldMap;var date=dateToNSTimeInterval(birthdate);if(typeof date!=="number"){this.addCustomField("birth date",date)}else{if(field){field.v=date}else{fieldMap={k:"date",n:"birthdate",t:"birth date",v:date,a:{guarded:"yes"}};addFieldToSection(fieldMap,{name:"name",title:"Identification"})}}};this.occupation=function getOccupation(){var field=fieldWithNameInSection("occupation","name");if(field){return field.v}};this.setOccupation=function setOccupation(occupation){var field=fieldWithNameInSection("occupation","name"),fieldMap;if(field){field.v=occupation}else{fieldMap={k:"string",n:"occupation",t:"occupation",v:occupation,a:{guarded:"yes"}};addFieldToSection(fieldMap,{name:"name",title:"Identification"})}};this.company=function getCompany(){var field=fieldWithNameInSection("company","name");if(field){return field.v}};this.setCompany=function setCompany(company){var field=fieldWithNameInSection("company",""),fieldMap;if(field){field.v=company}else{fieldMap={k:"string",n:"company",t:"company",v:company,a:{guarded:"yes"}};addFieldToSection(fieldMap,{name:"name",title:"Identification"})}};this.department=function getDepartment(){var field=fieldWithNameInSection("department","");if(field){return field.v}};this.setDepartment=function setDepartment(department){var field=fieldWithNameInSection("department",""),fieldMap;if(field){field.v=department}else{fieldMap={k:"string",n:"department",t:"department",v:department,a:{guarded:"yes"}};addFieldToSection(fieldMap,{name:"name",title:"Identification"})}};this.jobTitle=function getJobTitle(){var field=fieldWithNameInSection("jobtitle","");if(field){return field.v}};this.setJobTitle=function setJobTitle(jobTitle){var field=fieldWithNameInSection("jobtitle",""),fieldMap;if(field){field.v=jobTitle}else{fieldMap={k:"string",n:"jobTitle",t:"job title",v:jobTitle,a:{guarded:"yes"}};addFieldToSection(fieldMap,{name:"jobtitle",title:"Identification"})}};this.address=function getAddress(){var field=fieldWithNameInSection("address","address");if(field){return field.v}};this.setAddress=function setAddress(address){var field=fieldWithNameInSection("address","address"),fieldMap;if(field){field.v=address}else{fieldMap={k:"address",n:"address",t:"address",v:address,a:{guarded:"yes"}};addFieldToSection(fieldMap,{name:"address",title:"Address"})}};this.city=function getCity(){var field=fieldWithNameInSection("address","address");if(field){return field.v.city}};this.setCity=function setCity(city){var field=fieldWithNameInSection("address","address"),fieldMap;if(field){field.v.city=city}else{fieldMap={k:"address",n:"address",t:"address",v:{city:city},a:{guarded:"yes"}};addFieldToSection(fieldMap,{name:"address",title:"Address"})}};this.state=function getState(){var field=fieldWithNameInSection("address","address");if(field){return field.v.state}};this.setState=function setState(state){var field=fieldWithNameInSection("address","address"),fieldMap;if(field){field.v.state=state}else{fieldMap={k:"address",n:"address",t:"address",v:{state:state},a:{guarded:"yes"}};addFieldToSection(fieldMap,{name:"address",title:"Address"})}};this.streetAddress=function getStreetAddress(){var field=fieldWithNameInSection("address","address");if(field){return field.v.street}};this.setStreetAddress=function setStreetAddress(street){var field=fieldWithNameInSection("address","address"),fieldMap;if(field){field.v.street=street}else{fieldMap={k:"address",n:"address",t:"address",v:{street:street},a:{guarded:"yes"}};addFieldToSection(fieldMap,{name:"address",title:"Address"})}};this.country=function getCountry(){var field=fieldWithNameInSection("address","address");if(field){return field.v.country}};this.setCountry=function setCountry(country){var field=fieldWithNameInSection("address","address"),fieldMap;country=trimAndDowncaseString(country);if(field){field.v.country=country}else{fieldMap={k:"address",n:"address",t:"address",v:{country:country},a:{guarded:"yes"}};addFieldToSection(fieldMap,{name:"address",title:"Address"})}};this.zip=function getZip(){var field=fieldWithNameInSection("address","address");if(field){return field.v.zip}};this.setZip=function setZip(zip){var field=fieldWithNameInSection("address","address"),fieldMap;if(field){field.v.zip=zip}else{fieldMap={k:"address",n:"address",t:"address",v:{zip:zip},a:{guarded:"yes"}};addFieldToSection(fieldMap,{name:"address",title:"Address"})}};this.defaultPhone=function getDefaultPhone(){var field=fieldWithNameInSection("defphone","address");if(field){return field.v}};this.setDefaultPhone=function setDefaultPhone(defaultPhone){var field=fieldWithNameInSection("defphone","address"),fieldMap;if(field){field.v=defaultPhone}else{fieldMap={k:"phone",n:"defphone",t:"default phone",v:defaultPhone,a:{guarded:"yes"}};addFieldToSection(fieldMap,{name:"address",title:"Address"})}};this.homePhone=function getHomePhone(){var field=fieldWithNameInSection("homephone","address");if(field){return field.v}};this.setHomePhone=function setHomePhone(homePhone){var field=fieldWithNameInSection("homephone","address"),fieldMap;if(field){field.v=homePhone}else{fieldMap={k:"phone",n:"homephone",t:"home",v:homePhone,a:{guarded:"yes"}};addFieldToSection(fieldMap,{name:"address",title:"Address"})}};this.fax=function getFax(){var field=fieldWithNameInSection("fax","address");if(field){return field.v}};this.setFax=function setFax(fax){var field=fieldWithNameInSection("fax","address"),fieldMap;if(field){field.v=fax}else{fieldMap={k:"phone",n:"fax",t:"fax",v:fax};addFieldToSection(fieldMap,{name:"address",title:"Address"})}};this.cellPhone=function getCellPhone(){var field=fieldWithNameInSection("cellphone","address");if(field){return field.v}};this.setCellPhone=function setCellPhone(cellPhone){var field=fieldWithNameInSection("cellphone","address"),fieldMap;if(field){field.v=cellPhone}else{fieldMap={k:"phone",n:"cellphone",t:"cell",v:cellPhone,a:{guarded:"yes"}};addFieldToSection(fieldMap,{name:"address",title:"Address"})}};this.businessPhone=function getBusinessPhone(){var field=fieldWithNameInSection("busphone","address");if(field){return field.v}};this.setBusinessPhone=function setBusinessPhone(businessPhone){var field=fieldWithNameInSection("busphone","address"),fieldMap;if(field){field.v=businessPhone}else{fieldMap={k:"phone",n:"busphone",t:"business",v:businessPhone,a:{guarded:"yes"}};addFieldToSection(fieldMap,{name:"address",title:"Address"})}};this.username=function getUsername(){var field=fieldWithNameInSection("username","internet");if(field){return field.v}};this.setUsername=function setUsername(username){var field=fieldWithNameInSection("username","internet"),fieldMap;if(field){field.v=username}else{fieldMap={k:"string",n:"username",t:"username",v:username,a:{guarded:"yes"}};addFieldToSection(fieldMap,{name:"internet",title:"Internet Details"})}};this.reminderq=function getReminderq(){var field=fieldWithNameInSection("reminderq","internet");if(field){return field.v}};this.setReminderq=function setReminderq(reminderq){var field=fieldWithNameInSection("reminderq","internet"),fieldMap;if(field){field.v=reminderq}else{fieldMap={k:"string",n:"reminderq",t:"reminder question",v:reminderq,a:{guarded:"yes"}};addFieldToSection(fieldMap,{name:"internet",title:"Internet Details"})}};this.remindera=function getRemindera(){var field=fieldWithNameInSection("remindera","internet");if(field){return field.v}};this.setRemindera=function setRemindera(remindera){var field=fieldWithNameInSection("remindera","internet"),fieldMap;if(field){field.v=remindera}else{fieldMap={k:"string",n:"remindera",t:"reminder answer",v:remindera,a:{guarded:"yes"}};addFieldToSection(fieldMap,{name:"internet",title:"Internet Details"})}};this.email=function getEmail(){var field=fieldWithNameInSection("email","internet");if(field){return field.v}};this.setEmail=function setEmail(email){var field=fieldWithNameInSection("email","internet"),fieldMap;if(field){field.v=email}else{fieldMap={k:"string",n:"email",t:"email",v:email,a:{guarded:"yes"}};addFieldToSection(fieldMap,{name:"internet",title:"Internet Details"})}};this.website=function getWebsite(){var field=fieldWithNameInSection("website","internet");if(field){return field.v}};this.setWebsite=function setWebsite(website){var field=fieldWithNameInSection("website","internet"),fieldMap;if(field){field.v=website}else{fieldMap={k:"string",n:"website",t:"website",v:website,a:{guarded:"yes"}};addFieldToSection(fieldMap,{name:"internet",title:"Internet Details"})}};this.icq=function getIcq(){var field=fieldWithNameInSection("icq","internet");if(field){return field.v}};this.setIcq=function setIcq(icq){var field=fieldWithNameInSection("icq","internet"),fieldMap;if(field){field.v=icq}else{fieldMap={k:"string",n:"icq",t:"ICQ",v:icq,a:{guarded:"yes"}};addFieldToSection(fieldMap,{name:"internet",title:"Internet Details"})}};this.skype=function getSkype(){var field=fieldWithNameInSection("skype","internet");if(field){return field.v}};this.setSkype=function setSkype(skype){var field=fieldWithNameInSection("skype","internet"),fieldMap;if(field){field.v=skype}else{fieldMap={k:"string",n:"skype",t:"skype",v:skype,a:{guarded:"yes"}};addFieldToSection(fieldMap,{name:"internet",title:"Internet Details"})}};this.aim=function getAim(){var field=fieldWithNameInSection("aim","internet");if(field){return field.v}};this.setAim=function setAim(aim){var field=fieldWithNameInSection("aim","internet"),fieldMap;if(field){field.v=aim}else{fieldMap={k:"string",n:"aim",t:"AOL/AIM",v:aim,a:{guarded:"yes"}};addFieldToSection(fieldMap,{name:"internet",title:"Internet Details"})}};this.yahoo=function getYahoo(){var field=fieldWithNameInSection("yahoo","internet");if(field){return field.v}};this.setYahoo=function setYahoo(yahoo){var field=fieldWithNameInSection("yahoo","internet"),fieldMap;if(field){field.v=yahoo}else{fieldMap={k:"string",n:"yahoo",t:"Yahoo",v:yahoo,a:{guarded:"yes"}};addFieldToSection(fieldMap,{name:"internet",title:"Internet Details"})}};this.msn=function getMsn(){var field=fieldWithNameInSection("msn","internet");if(field){return field.v}};this.setMsn=function setMsn(msn){var field=fieldWithNameInSection("msn","internet"),fieldMap;if(field){field.v=msn}else{fieldMap={k:"string",n:"msn",t:"msn",v:msn,a:{guarded:"yes"}};addFieldToSection(fieldMap,{name:"internet",title:"Internet Details"})}};this.forumSignature=function getForumSignature(){var field=fieldWithNameInSection("forumsig","internet");if(field){return field.v}};this.setForumSignature=function setForumSignature(forumSig){var field=fieldWithNameInSection("forumsig","internet"),fieldMap;if(field){field.v=forumSig}else{fieldMap={k:"string",n:"forumsig",t:"forum signature",v:forumSig,a:{guarded:"yes"}};addFieldToSection(fieldMap,{name:"internet",title:"Internet Details"})}};var customFieldsSection={name:guid(),title:"Other Fields"};this.addCustomField=function addCustomField(fieldName,fieldValue){addFieldToSection({k:"string",t:fieldName,v:fieldValue},customFieldsSection)};this.toString=function toString(){return"[object OPIdentity]"};function fieldWithNameInSection(fieldName,sectionName){var section=sectionNamed(sectionName);if(section){fields=section.fields.filter(function(field){return field.n===fieldName});if(fields.length>1){}return fields[0]}}function sectionNamed(needle){var matchedSections=that.details.sections.filter(function(section){return section.name===needle});if(matchedSections.length>1){}return matchedSections[0]}function addFieldToSection(fieldObject,inSection){var section=sectionNamed(inSection.name);if(!section){that.details.sections.push({fields:[fieldObject],name:inSection.name,title:inSection.title})}else{section.fields.push(fieldObject)}}}function OPLogin(){this.details={fields:[],sections:[]};this.URLs=[];this.categoryUUID="001";this.overview={};this.title=function getTitle(){return this.overview.title};this.setTitle=function setTitle(aTitle){this.overview.title=aTitle};this.username=function username(){var usernameFields=fieldWithDesignation("username");return usernameFields.length>0?usernameFields[0]:undefined};this.setUsername=function setUsername(username){var usernameFields=fieldWithDesignation("username");if(usernameFields.length>0){usernameFields[0].value=username}else{this.details.fields.push({name:"username",designation:"username",value:username})}};this.password=function password(){var passwordFields=fieldWithDesignation("password");return passwordFields.length>0?passwordFields[0]:undefined};this.setPassword=function setPassword(password){var passwordFields=fieldWithDesignation("password");if(passwordFields.length>0){passwordFields[0].value=password}else{this.details.fields.push({name:"password",designation:"password",value:password})}};this.notes=function getNotes(){return this.details.notesPlain};this.setNotes=function setNotes(notes){this.details.notesPlain=notes};this.addNotes=function addNotes(noteText,separator){var notes=this.details.notesPlain||"";if(notes!=="")notes+=separator.toString();notes+=noteText;this.setNotes(notes)};this.addURL=function addURL(url,label){this.URLs.push({overview:{url:url,label:label||"website"}});if(this.URLs.length===1){this.overview.url=url}};this.addField=function addField(name,value,designation){var field={name:name,value:value};if(designation!==undefined){field.designation=designation}this.details.fields.push(field)};var customFieldsSection={name:guid(),title:"Other Fields"};this.addCustomField=function addCustomField(fieldName,fieldValue){addFieldToSection({k:"string",t:fieldName,v:fieldValue},customFieldsSection)};this.toString=function toString(){return"[object OPLogin]"};var that=this;function fieldWithDesignation(designation){return that.details.fields.filter(function(field){return field.designation===designation})}function sectionNamed(needle){var matchedSections=that.details.sections.filter(function(section){return section.name===needle});if(matchedSections.length>1){}return matchedSections[0]}function addFieldToSection(fieldObject,inSection){var section=sectionNamed(inSection.name);if(!section){that.details.sections.push({fields:[fieldObject],name:inSection.name,title:inSection.title})}else{section.fields.push(fieldObject)}}}function OPSecureNote(){this.overview={title:""};this.details={notesPlain:""};this.categoryUUID="003";this.title=function getTitle(){return this.overview.title};this.setTitle=function setTitle(aTitle){this.overview.title=aTitle};this.body=function getBody(){return this.details.notesPlain};this.setBody=function setBody(body){this.details.notesPlain=body};this.addNotes=function addNotes(string,separator){var notes=this.details.notesPlain||"";if(notes!==""&&separator!=null)notes+=separator.toString();notes+=string;this.setBody(notes)};this.toString=function toString(){return"[object OPSecureNote]"};this.addCustomField=function addCustomField(fieldName,fieldValue){this.addNotes(fieldName+": "+fieldValue,"\n")}}function OPSocialSecurityNumber(){this.categoryUUID="108";this.details={sections:[{name:"",title:"",fields:[{k:"string",n:"name",t:"name"},{k:"concealed",t:"number",n:"number",a:{generate:"off"},v:""}]}]};this.overview={title:"",ainfo:""};this.title=function getTitle(){return this.overview.title};this.setTitle=function setTitle(aTitle){this.overview.title=aTitle};this.name=function getName(){return this.details.sections[0].fields[0].v};this.setName=function setName(name){this.details.sections[0].fields[0].v=name};this.number=function getNumber(){return this.details.sections[0].fields[1].v};this.setNumber=function setNumber(number){this.details.sections[0].fields[1].v=number};this.notes=function getNotes(){return this.details.notesPlain};this.setNotes=function setNotes(notes){this.details.notesPlain=notes};this.addNotes=function addNotes(noteText,separator){var notes=this.details.notesPlain||"";if(notes!==""&&separator)notes+=separator.toString();notes+=noteText;this.setNotes(notes)};var customFieldsSection={name:guid(),title:"Other Fields"};this.addCustomField=function addCustomField(fieldName,fieldValue){addFieldToSection({k:"string",t:fieldName,v:fieldValue},customFieldsSection)};this.toString=function toString(){return"[object OPSocialSecurityNumber]"};var that=this;function sectionNamed(needle){var matchedSections=that.details.sections.filter(function(section){return section.name===needle});if(matchedSections.length>1){}return matchedSections[0]}function addFieldToSection(fieldObject,inSection){var section=sectionNamed(inSection.name);if(!section){that.details.sections.push({fields:[fieldObject],name:inSection.name,title:inSection.title})}else{section.fields.push(fieldObject)}}}function OPSoftwareLicense(){var that=this;this.details={sections:[]};this.categoryUUID="100";this.overview={};this.title=function getTitle(){return this.overview.title};this.setTitle=function setTitle(aTitle){this.overview.title=aTitle};this.notes=function getNotes(){return this.details.notesPlain};this.setNotes=function setNotes(notes){this.details.notesPlain=notes};this.addNotes=function addNotes(noteText,separator){var notes=this.details.notesPlain||"";if(notes!==""&&separator!=null)notes+=separator;notes+=noteText;this.setNotes(notes)};this.version=function getVersion(){var field=fieldWithNameInSection("product_version","");if(field){return field.v}};this.setVersion=function setVersion(version){var field=fieldWithNameInSection("product_version",""),fieldMap;if(field){field.v=version}else{fieldMap={k:"string",n:"product_version",t:"version",v:version};addFieldToSection(fieldMap,{name:"",title:""})}};this.licenseKey=function getLicenseKey(){var field=fieldWithNameInSection("reg_code","");if(field){return field.v}};this.setLicenseKey=function setLicenseKey(key){var field=fieldWithNameInSection("reg_code",""),fieldMap;if(field){field.v=key}else{fieldMap={k:"string",n:"reg_code",t:"license key",v:key};addFieldToSection(fieldMap,{name:"",title:""})}};this.owner=function getOwner(){var field=fieldWithNameInSection("reg_name","customer");if(field){return field.v}};this.setOwner=function setOwner(owner){var field=fieldWithNameInSection("reg_name","customer"),fieldMap;if(field){field.v=owner}else{fieldMap={k:"string",n:"reg_name",t:"licensed to",v:owner};addFieldToSection(fieldMap,{name:"customer",title:"Customer"})}};this.email=function getEmail(){var field=fieldWithNameInSection("reg_email","customer");if(field){return field.v}};this.setEmail=function setEmail(value){var field=fieldWithNameInSection("reg_email","customer"),fieldMap;if(field){field.v=value}else{fieldMap={k:"string",n:"reg_email",t:"registered email",v:value};addFieldToSection(fieldMap,{name:"customer",title:"Customer"})}};this.company=function getCompany(){var field=fieldWithNameInSection("company","customer");if(field){return field.v}};this.setCompany=function setCompany(value){var field=fieldWithNameInSection("company","customer"),fieldMap;if(field){field.v=value}else{fieldMap={k:"string",n:"company",t:"company",v:value};addFieldToSection(fieldMap,{name:"customer",title:"Customer"})}};this.downloadLink=function getDownloadLink(){var field=fieldWithNameInSection("download_link","publisher");if(field){return field.v}};this.setDownloadLink=function setDownloadLink(value){var field=fieldWithNameInSection("download_link","publisher"),fieldMap;if(field){field.v=value}else{fieldMap={k:"URL",n:"download_link",t:"download page",v:value};addFieldToSection(fieldMap,{name:"publisher",title:"Publisher"})}};this.publisher=function getPublisher(){var field=fieldWithNameInSection("publisher_name","publisher");if(field){return field.v}};this.setPublisher=function setPublisher(value){var field=fieldWithNameInSection("publisher_name","publisher"),fieldMap;if(field){field.v=value}else{fieldMap={k:"string",n:"publisher_name",t:"publisher",v:value};addFieldToSection(fieldMap,{name:"publisher",title:"Publisher"})}};this.publisherWebsite=function getPublisherWebsite(){var field=fieldWithNameInSection("publisher_website","publisher");if(field){return field.v}};this.setPublisherWebsite=function setPublisherWebsite(value){var field=fieldWithNameInSection("publisher_website","publisher"),fieldMap;if(field){field.v=value}else{fieldMap={k:"URL",n:"publisher_website",t:"website",v:value};addFieldToSection(fieldMap,{name:"publisher",title:"Publisher"})}};this.retailPrice=function getRetailPrice(){var field=fieldWithNameInSection("retail_price","publisher");if(field){return field.v}};this.setRetailPrice=function setRetailPrice(value){var field=fieldWithNameInSection("retail_price","publisher"),fieldMap;if(field){field.v=value}else{fieldMap={k:"string",n:"retail_price",t:"retail price",v:value};addFieldToSection(fieldMap,{name:"publisher",title:"Publisher"})}};this.supportEmail=function getSupportEmail(){var field=fieldWithNameInSection("support_email","publisher");if(field){return field.v}};this.setSupportEmail=function setSupportEmail(value){var field=fieldWithNameInSection("support_email","publisher"),fieldMap;if(field){field.v=value}else{fieldMap={k:"email",n:"support_email",t:"support email",v:value};addFieldToSection(fieldMap,{name:"publisher",title:"Publisher"})}};this.purchaseDate=function getPurchaseDate(){var field=fieldWithNameInSection("order_date","order");if(field){return field.v*1e3}};this.setPurchaseDate=function setPurchaseDate(value){var field=fieldWithNameInSection("order_date","order"),fieldMap;var date=dateToNSTimeInterval(value);if(typeof date!=="number"){this.addCustomField("purchase date",date)}else{if(field){field.v=date}else{fieldMap={k:"date",n:"order_date",t:"purchase date",v:date};addFieldToSection(fieldMap,{name:"order",title:"Order"})}}};this.orderNumber=function getOrderNumber(){var field=fieldWithNameInSection("order_number","order");if(field){return field.v}};this.setOrderNumber=function setOrderNumber(value){var field=fieldWithNameInSection("order_number","order"),fieldMap;if(field){field.v=value}else{fieldMap={k:"string",n:"order_number",t:"order number",v:value};addFieldToSection(fieldMap,{name:"order",title:"Order"})}};this.orderTotal=function getOrderTotal(){var field=fieldWithNameInSection("order_total","order");if(field){return field.v}};this.setOrderTotal=function setOrderTotal(value){var field=fieldWithNameInSection("order_total","order"),fieldMap;if(field){field.v=value}else{fieldMap={k:"string",n:"order_total",t:"order total",v:value};addFieldToSection(fieldMap,{name:"order",title:"Order"})}};var customFieldsSection={name:guid(),title:"Other Fields"};this.addCustomField=function addCustomField(fieldName,fieldValue){addFieldToSection({k:"string",t:fieldName,v:fieldValue},customFieldsSection)};this.toString=function toString(){return"[object OPSoftwareLicense]"};function fieldWithNameInSection(fieldName,sectionName){var section=sectionNamed(sectionName);if(section){fields=section.fields.filter(function(field){return field.n===fieldName});if(fields.length>1){}return fields[0]}}function addFieldToSection(fieldObject,inSection){var section=sectionNamed(inSection.name);if(!section){that.details.sections.push({fields:[fieldObject],name:inSection.name,title:inSection.title})}else{section.fields.push(fieldObject)}}function sectionNamed(needle){var matchedSections=that.details.sections.filter(function(section){return section.name===needle});if(matchedSections.length>1){}return matchedSections[0]}}(function CSVImporterInit(){Importers.csv=function CSVImport(data,type){this.data=data;this.name="generic csv";this.type=type;this.process=function process(){var parser=new CSVParser(this.data);parser.parse();return parser.rows};this.run=function run(){var rows=this.process(),items=[],itemCreationFunction;this.fieldNames=Object.keys(this.map[this.type]);switch(type){case"login":itemCreationFunction=loginForRow;break;case"creditcard":itemCreationFunction=creditCardForRow;break;case"software":itemCreationFunction=softwareLicenseForRow;break;default:itemCreationFunction=secureNoteForRow}rows.forEach(function(row){items.push(itemCreationFunction.apply(this,[row]))},this);return items};this.map={login:{title:0,location:1,username:2,password:3,notes:4},creditcard:{title:0,cardnumber:1,expirydate:2,cardholder:3,pin:4,bank:5,cvv:6,notes:7},software:{title:0,version:1,licensekey:2,owner:3,email:4,company:5,downloadlink:6,publisher:7,publisherwebsite:8,retailprice:9,supportemail:10,purchasedate:11,ordernumber:12,notes:13},securenote:{title:0}}}})();(function LastPassInit(){"use strict";Importers.lastpass=function LastPass(data,type){var that=this;this.data=data;this.name="lastpass";this.type=type;this.vault_map={login:{location:0,username:1,password:2,notes:3,title:4,ignore:6},creditcard:{cardholder:0,cardtype:1,cardnumber:2,cvv:3,validfrom:4,expirydate:5,notes:6,title:7},bankaccount:{bankname:0,accounttype:1,routingnumber:2,accountnumber:3,swift:4,iban:5,pin:6,bankaddress:7,bankphone:8,notes:9,title:10},driverlicense:{number:0,expirydate:1,licenseclass:2,name:3,address:[4,5,6,7,8],state:6,country:8,birthdate:9,sex:10,height:11,notes:12,title:13},socialsecuritynumber:{name:0,number:1,notes:2,title:3},software:{licensekey:0,version:1,publisher:2,supportemail:3,publisherwebsite:4,retailprice:5,purchasedate:6,ordernumber:7,ordertotal:9,notes:10,title:11},securenote:{body:3,title:4,extras:5}};this.profile_map={identity:{title:0,firstname:[3,4,5],middlename:6,lastname:[7,8,9],username:10,sex:11,birthday:12,company:14,street:[15,16,17],city:18,state:20,zip:22,country:23,email:27,defphone:[30,31],fax:[33,34],homephone:[36,37],cellphone:[39,40],extras:[19,26,28]},creditcard:{title:0,cardholder:41,cardnumber:42,validfrom:43,expirydate:44,cvv:45,extras:[46]},bankaccount:{title:0,bankname:47,accountnumber:48,routingnumber:49,extras:null},socialsecuritynumber:{title:0,name:[3,4,5,6,7,8,9],number:13,extras:null},securenote:{title:0,body:50}};this.map=this.vault_map;this.process=function process(){var parser=new CSVParser(this.data,{strict:false});
parser.parse();return parser.rows};this.run=function run(){var rows=this.process(),items=[],row,rowItems=[];this.defaultFieldNames=rows.shift();rows.forEach(function(row){this.fieldNames=this.defaultFieldNames;if(type==="login"){this.map=this.vault_map;if(row[0]==="http://sn"){rowItems.push(this.parseItemFromSecureNote(row))}else{rowItems.push(loginForRow.apply(this,[row]))}}else if(type==="formfill"){this.map=this.profile_map;var item_found=false,special_map,special_row;if(row[42]){item_found=true;rowItems.push(creditCardForRow.apply(this,[row]))}if(row[48]){item_found=true;rowItems.push(bankAccountForRow.apply(this,[row]))}if(row[3]){item_found=true;rowItems.push(identityForRow.apply(this,[row]))}if(row[13]){item_found=true;rowItems.push(socialSecurityNumberForRow.apply(this,[row]))}if(!item_found){rowItems.push(secureNoteForRow.apply(this,[row]))}else if(row[51]!=null){special_row=row.slice();this.fieldNames=this.defaultFieldNames.slice();special_row.splice(1,49);this.fieldNames.splice(1,49);special_map={title:0,body:1};rowItems.push(secureNoteForRow.apply(this,[special_row,special_map]));this.fieldNames=this.defaultFieldNames}else if(row[50]){special_map={title:0,body:50,extras:null};rowItems.push(secureNoteForRow.apply(this,[row,special_map]))}}items=items.concat(rowItems);rowItems=[]},this);return items};this.vault_function_map={"Bank Account":bankAccountForRow,"Credit Card":creditCardForRow,"Driver's License":driverLicenseForRow,"Social Security":socialSecurityNumberForRow,"Software License":softwareLicenseForRow};this.parseItemFromSecureNote=function parseItemFromSecureNote(readOnlyRow){var row=readOnlyRow.slice();var body=row[3];var title=row[4];var type_match=body.match(/^NoteType:(.+)/);if(type_match==null){return secureNoteForRow.apply(this,[row])}else{var notetype=type_match[1];if(notetype in this.vault_function_map){var sections=body.slice(type_match[0].length).split("\nNotes:");var fields=sections[0].replace(/^\s+|\s+$/g,"").split("\n");var notes=sections[1].replace(/^\s+|\s+$/g,"");fields=fields.map(function(f){return f.split(/:(.+)?/,2)});this.fieldNames=fields.map(function(f){return f[0]}).concat(["Notes","Title"]);var special_row=fields.map(function(f){return f[1]}).concat([notes,title]);return this.vault_function_map[notetype].apply(this,[special_row])}else{row[3]=row[3].replace(/(^|\n)([^:]+):(\S.+)/g,"$1$2: $3");return secureNoteForRow.apply(this,[row])}}}}})();(function SplashIDInit(){Importers.splashid=function SplashID(data){log_debug("Importers.splashid");this.process=function process(){var parser=new CSVParser(this.data,{strict:false});parser.parse();log_debug(JSON.stringify(parser.rows));return parser.rows};this.data=data;this.name="splashid";this.run=function run(){var rows=this.process(),row,i,ii,itemCreationFunction,isTypeRow;this.fieldNames=items=rowItems=[];if(rows[0][0]!=="SplashID vID File -v3.0"){throw"Invalid SplashID format. Be sure the exported data is vID 3 format."}rows.splice(0,2);var defaultFieldNames,mergeFieldNames=function(rowFieldName,index,rowFieldNames){if(rowFieldName===""){if(defaultFieldNames[index]===undefined){rowFieldNames[index]="Field "+(index+1);return}rowFieldNames[index]=defaultFieldNames[index]}};for(i=0,ii=rows.length;i<ii;i++){row=rows[i];isTypeRow=row[0]==="T";row.splice(0,2);if(isTypeRow){defaultFieldNames=row.slice(1);switch(row[0]){case"Credit Cards":itemCreationFunction=creditCardForRow;break;case"Identification":itemCreationFunction=driverLicenseForRow;break;case"Bank Accounts":itemCreationFunction=bankAccountForRow;break;case"Web Logins":itemCreationFunction=loginForRow;break;case"Serial Numbers":itemCreationFunction=softwareLicenseForRow;break;default:itemCreationFunction=secureNoteForRow}}else{rowFieldNames=row.splice(11,10);rowFieldNames.forEach(mergeFieldNames);this.fieldNames=rowFieldNames;if(itemCreationFunction){log_debug(row.length+" fields: "+JSON.stringify(row));if(row.length!==0){var item=itemCreationFunction.apply(this,[row]);log_debug(item+" > "+JSON.stringify(item));items.push(item)}}rowFieldNames=null}}return items};this.map={login:{title:0,username:1,password:2,location:3,notes:-1},driverlicense:{title:0,number:1,name:2,expirydate:3,notes:-1},creditcard:{title:0,cardnumber:1,expirydate:2,cardholder:3,pin:4,bank:5,notes:-1},bankaccount:{title:0,bankname:4,accountnumber:1,owner:3,bankphone:5,pin:2,notes:-1},software:{title:0,licensekey:1,notes:-1},securenote:{title:0}}}})();if(typeof importController!=="object"){importController={importItem:function(item){print(JSON.stringify(item))},log:function(message){print(message)},argumentAtIndex:function(index){return a[index]},argumentCount:a.length}}var args=[],argumentIndex;for(argumentIndex=0;argumentIndex<importController.argumentCount;argumentIndex++){args.push(importController.argumentAtIndex(argumentIndex))}var sourceApplication=args[1],types=Array.prototype.slice.call(args,2);var importer=new Importers[sourceApplication](args[0],types[0]);var items=importer.run();items.forEach(function(item){if(item){importController.importItem(JSON.stringify(item))}});